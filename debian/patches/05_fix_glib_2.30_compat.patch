commit bfd344cdece5de6230ff611e3e1c66d90913dc47
Author: Colin Walters <walters@verbum.org>
Date:   Wed May 11 14:19:24 2011 -0400

    Use Shell.get_file_contents_utf8_sync over GLib.file_get_contents
    
    We need to fix the latter to return a byte array, which gjs doesn't
    deal with well right now.
    
    https://bugzilla.gnome.org/show_bug.cgi?id=649981

diff --git a/js/ui/placeDisplay.js b/js/ui/placeDisplay.js
index c50c281..8592ee1 100644
--- a/js/ui/placeDisplay.js
+++ b/js/ui/placeDisplay.js
@@ -270,10 +270,7 @@ PlacesManager.prototype = {
         if (!GLib.file_test(this._bookmarksPath, GLib.FileTest.EXISTS))
             return;
 
-        let [success, bookmarksContent, len] = GLib.file_get_contents(this._bookmarksPath);
-
-        if (!success)
-            return;
+        let bookmarksContent = Shell.get_file_contents_utf8_sync(this._bookmarksPath);
 
         let bookmarks = bookmarksContent.split('\n');
 
diff --git a/js/ui/windowManager.js b/js/ui/windowManager.js
index b113a1a..a3e2918 100644
--- a/js/ui/windowManager.js
+++ b/js/ui/windowManager.js
@@ -6,6 +6,7 @@ const Gio = imports.gi.Gio;
 const Lang = imports.lang;
 const Meta = imports.gi.Meta;
 const St = imports.gi.St;
+const Shell = imports.gi.Shell;
 
 const AltTab = imports.ui.altTab;
 const WorkspaceSwitcherPopup = imports.ui.workspaceSwitcherPopup;
@@ -22,8 +23,7 @@ function getDimShader() {
     if (dimShader === null)
         return null;
     if (!dimShader) {
-        let [success, source, length] = GLib.file_get_contents(global.datadir +
-                                                               '/shaders/dim-window.glsl');
+        let source = Shell.get_file_contents_utf8_sync(global.datadir + '/shaders/dim-window.glsl');
         try {
             let shader = new Clutter.Shader();
             shader.set_fragment_source(source, -1);
